import{getAllTickets as r,saveAllStates as o}from"../storage.js";import{clamp as n}from"../util.js";const i=1,c=0,s=900,u=300;let a=!1,l=0,d=[],y={},h=0;function k(){d.forEach((t,e)=>{var e=e-h,r=(e<0?-1:1)*u*(1-.9**Math.abs(e)),o=.9**Math.abs(e);t.position=`translate(calc(${r}vw - 50%), -50%) scale(${o})`,t.zIndex=s-Math.abs(e)})}function m(t){y.currentCardPosition.innerText=t+1+" / "+d.length}function e(t){h=n(h+t,0,d.length-1),k(),m(h)}function t(){return a}function g(){l=r().length,y.ticketHistoryCount.innerText=l}function f(e){[y.historyWrapper,y.ticketHistoryBackground,y.arrowButtons,y.historyCloseButton].forEach(t=>{t.style.display=e?"inline":"none"}),a&&(y.ticketHistoryTickets.innerHTML="",a=!1)}function p(t){var e=d.indexOf(t);-1===e||e>l||(y.ticketHistoryTickets.removeChild(t),d.splice(e,1),(t=r()).splice(e,1),o(t),h=0===d.length?0:n(h,0,d.length-1),k(),0===d.length&&(h=0,f(c)),g())}function B(){var t,e;a?f(c):(d=[],t=r(),l=t.length,0===t.length?((e=y.historyCircleButton).classList.add("shake"),setTimeout(()=>{e.classList.remove("shake")},1e3)):(f(i),r().forEach((t,e)=>{var r=document.createElement("saved-ticket"),t={currentMessage:t.currentMessage,currentNumbers:t.currentNumbers,currentImageFront:t.currentImageFront};r.index=e,r.content=t,d.push(r)}),d.forEach(t=>{y.ticketHistoryTickets.append(t)}),m(h),k(),a=!0))}window.addEventListener("keydown",t=>{a&&("ArrowRight"===t.key&&e(1),"ArrowLeft"===t.key)&&e(-1)}),window.addEventListener("DOMContentLoaded",function(){(y={historyCircleButton:document.querySelector("#ticketHistoryCircle"),ticketHistoryCount:document.querySelector("#ticketHistoryCount"),ticketHistoryTickets:document.querySelector("#ticketHistoryTickets"),ticketHistoryBackground:document.querySelector(".ticketHistoryBackground"),arrowButtons:document.querySelector(".historyArrowButtons"),historyCloseButton:document.querySelector("#closeHistory"),leftButton:document.querySelector(".left"),rightButton:document.querySelector(".right"),currentCardPosition:document.querySelector("#currentCardPosition"),historyWrapper:document.querySelector(".historyWrapper")}).historyCircleButton.addEventListener("click",B),y.historyCloseButton.addEventListener("click",()=>{f(c)}),y.leftButton.addEventListener("click",()=>{e(-1)}),y.rightButton.addEventListener("click",()=>{e(1)}),g(),m(0)});export{k as translateCards,t as isHistoryOnScreen,g as updateticketHistoryCount,p as removeCard};